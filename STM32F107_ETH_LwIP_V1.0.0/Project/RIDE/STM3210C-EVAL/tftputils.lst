
D:\SAV\STM32_Documents\lwip_st_STM32\STM32F107_ETH_LwIP_V1.0.0\Project\RIDE\STM3210C-EVAL\tftputils.o:     file format elf32-littlearm
D:\SAV\STM32_Documents\lwip_st_STM32\STM32F107_ETH_LwIP_V1.0.0\Project\RIDE\STM3210C-EVAL\tftputils.o

Disassembly of section .text.tftp_decode_op:

00000000 <tftp_decode_op>:
tftp_decode_op():
D:\SAV\STM32_Documents\lwip_st_STM32\STM32F107_ETH_LwIP_V1.0.0\Utilities\lwip-1.3.1\port/tftputils.c:12

/* Extract the opcode from a TFTP message in a buffer */
tftp_opcode tftp_decode_op(char *buf)
{
  return (tftp_opcode)(buf[1]);
}
   0:	7840      	ldrb	r0, [r0, #1]
   2:	4770      	bx	lr
Disassembly of section .text.tftp_set_opcode:

00000000 <tftp_set_opcode>:
tftp_set_opcode():
D:\SAV\STM32_Documents\lwip_st_STM32\STM32F107_ETH_LwIP_V1.0.0\Utilities\lwip-1.3.1\port/tftputils.c:31

/* Set the opcode in the 2 first bytes for RRQ / WRQ / DATA / ACK / ERROR */
void tftp_set_opcode(char *buffer, tftp_opcode opcode)
{

  buffer[0] = 0;
   0:	2300      	movs	r3, #0
   2:	7003      	strb	r3, [r0, #0]
D:\SAV\STM32_Documents\lwip_st_STM32\STM32F107_ETH_LwIP_V1.0.0\Utilities\lwip-1.3.1\port/tftputils.c:32
  buffer[1] = (u8_t)opcode;
   4:	7041      	strb	r1, [r0, #1]
D:\SAV\STM32_Documents\lwip_st_STM32\STM32F107_ETH_LwIP_V1.0.0\Utilities\lwip-1.3.1\port/tftputils.c:33
}
   6:	4770      	bx	lr
Disassembly of section .text.tftp_set_errorcode:

00000000 <tftp_set_errorcode>:
tftp_set_errorcode():
D:\SAV\STM32_Documents\lwip_st_STM32\STM32F107_ETH_LwIP_V1.0.0\Utilities\lwip-1.3.1\port/tftputils.c:39

/* Set the errorcode in the 2 second bytes for ERROR */
void tftp_set_errorcode(char *buffer, tftp_errorcode errCode)
{

  buffer[2] = 0;
   0:	2300      	movs	r3, #0
   2:	7083      	strb	r3, [r0, #2]
D:\SAV\STM32_Documents\lwip_st_STM32\STM32F107_ETH_LwIP_V1.0.0\Utilities\lwip-1.3.1\port/tftputils.c:40
  buffer[3] = (u8_t)errCode;
   4:	70c1      	strb	r1, [r0, #3]
D:\SAV\STM32_Documents\lwip_st_STM32\STM32F107_ETH_LwIP_V1.0.0\Utilities\lwip-1.3.1\port/tftputils.c:41
}
   6:	4770      	bx	lr
Disassembly of section .text.tftp_set_data_message:

00000000 <tftp_set_data_message>:
tftp_set_data_message():
D:\SAV\STM32_Documents\lwip_st_STM32\STM32F107_ETH_LwIP_V1.0.0\Utilities\lwip-1.3.1\port/tftputils.c:59
  p[1] = htons(block);
}

/* Set the message int the n last bytes for DATA */
void tftp_set_data_message(char* packet, char* buf, int buflen)
{
   0:	b510      	push	{r4, lr}
D:\SAV\STM32_Documents\lwip_st_STM32\STM32F107_ETH_LwIP_V1.0.0\Utilities\lwip-1.3.1\port/tftputils.c:60
  memcpy(packet + 4, buf, buflen);
   2:	3004      	adds	r0, #4
   4:	f7ff fffe 	bl	0 <memcpy>
D:\SAV\STM32_Documents\lwip_st_STM32\STM32F107_ETH_LwIP_V1.0.0\Utilities\lwip-1.3.1\port/tftputils.c:61
}
   8:	bd10      	pop	{r4, pc}
   a:	46c0      	nop			(mov r8, r8)
Disassembly of section .text.tftp_set_block:

00000000 <tftp_set_block>:
tftp_set_block():
D:\SAV\STM32_Documents\lwip_st_STM32\STM32F107_ETH_LwIP_V1.0.0\Utilities\lwip-1.3.1\port/tftputils.c:51
  strcpy(buffer + 4, errormsg);
}

/* Set the block number in the 2 second bytes ACK / DATA */
void tftp_set_block(char* packet, u16_t block)
{
   0:	b510      	push	{r4, lr}
   2:	4604      	mov	r4, r0
D:\SAV\STM32_Documents\lwip_st_STM32\STM32F107_ETH_LwIP_V1.0.0\Utilities\lwip-1.3.1\port/tftputils.c:54

  u16_t *p = (u16_t *)packet;
  p[1] = htons(block);
   4:	4608      	mov	r0, r1
   6:	f7ff fffe 	bl	0 <htons>
   a:	8060      	strh	r0, [r4, #2]
D:\SAV\STM32_Documents\lwip_st_STM32\STM32F107_ETH_LwIP_V1.0.0\Utilities\lwip-1.3.1\port/tftputils.c:55
}
   c:	bd10      	pop	{r4, pc}
   e:	46c0      	nop			(mov r8, r8)
Disassembly of section .text.tftp_set_errormsg:

00000000 <tftp_set_errormsg>:
tftp_set_errormsg():
D:\SAV\STM32_Documents\lwip_st_STM32\STM32F107_ETH_LwIP_V1.0.0\Utilities\lwip-1.3.1\port/tftputils.c:45
  buffer[3] = (u8_t)errCode;
}

/* Set the error message in the last appropriate bytes for ERROR */
void tftp_set_errormsg(char * buffer, char* errormsg)
{
   0:	b510      	push	{r4, lr}
D:\SAV\STM32_Documents\lwip_st_STM32\STM32F107_ETH_LwIP_V1.0.0\Utilities\lwip-1.3.1\port/tftputils.c:46
  strcpy(buffer + 4, errormsg);
   2:	3004      	adds	r0, #4
   4:	f7ff fffe 	bl	0 <strcpy>
D:\SAV\STM32_Documents\lwip_st_STM32\STM32F107_ETH_LwIP_V1.0.0\Utilities\lwip-1.3.1\port/tftputils.c:47
}
   8:	bd10      	pop	{r4, pc}
   a:	46c0      	nop			(mov r8, r8)
Disassembly of section .text.tftp_extract_filename:

00000000 <tftp_extract_filename>:
tftp_extract_filename():
D:\SAV\STM32_Documents\lwip_st_STM32\STM32F107_ETH_LwIP_V1.0.0\Utilities\lwip-1.3.1\port/tftputils.c:23
  return ntohs(b[1]);
}

/* Extract the block number from a TFTP message in a buffer */
void tftp_extract_filename(char *fname, char *buf)
{
   0:	b510      	push	{r4, lr}
D:\SAV\STM32_Documents\lwip_st_STM32\STM32F107_ETH_LwIP_V1.0.0\Utilities\lwip-1.3.1\port/tftputils.c:24
  strcpy(fname, buf + 2);
   2:	3102      	adds	r1, #2
   4:	f7ff fffe 	bl	0 <strcpy>
D:\SAV\STM32_Documents\lwip_st_STM32\STM32F107_ETH_LwIP_V1.0.0\Utilities\lwip-1.3.1\port/tftputils.c:25
}
   8:	bd10      	pop	{r4, pc}
   a:	46c0      	nop			(mov r8, r8)
Disassembly of section .text.tftp_extract_block:

00000000 <tftp_extract_block>:
tftp_extract_block():
D:\SAV\STM32_Documents\lwip_st_STM32\STM32F107_ETH_LwIP_V1.0.0\Utilities\lwip-1.3.1\port/tftputils.c:16
  return (tftp_opcode)(buf[1]);
}

/* Extract the block number from a TFTP message in a buffer */
u16_t tftp_extract_block(char *buf)
{
   0:	b510      	push	{r4, lr}
D:\SAV\STM32_Documents\lwip_st_STM32\STM32F107_ETH_LwIP_V1.0.0\Utilities\lwip-1.3.1\port/tftputils.c:18
  u16_t *b = (u16_t*)buf;
  return ntohs(b[1]);
   2:	8840      	ldrh	r0, [r0, #2]
   4:	f7ff fffe 	bl	0 <ntohs>
D:\SAV\STM32_Documents\lwip_st_STM32\STM32F107_ETH_LwIP_V1.0.0\Utilities\lwip-1.3.1\port/tftputils.c:19
}
   8:	bd10      	pop	{r4, pc}
   a:	46c0      	nop			(mov r8, r8)
Disassembly of section .text.tftp_is_correct_ack:

00000000 <tftp_is_correct_ack>:
tftp_is_correct_ack():
D:\SAV\STM32_Documents\lwip_st_STM32\STM32F107_ETH_LwIP_V1.0.0\Utilities\lwip-1.3.1\port/tftputils.c:65
  memcpy(packet + 4, buf, buflen);
}

/* Check if the received acknowledgement is correct */
u32_t tftp_is_correct_ack(char *buf, int block)
{
   0:	b570      	push	{r4, r5, r6, lr}
   2:	4604      	mov	r4, r0
   4:	460d      	mov	r5, r1
D:\SAV\STM32_Documents\lwip_st_STM32\STM32F107_ETH_LwIP_V1.0.0\Utilities\lwip-1.3.1\port/tftputils.c:67
  /* first make sure this is a data ACK packet */
  if (tftp_decode_op(buf) != TFTP_ACK)
   6:	f7ff fffe 	bl	0 <tftp_is_correct_ack>
   a:	2804      	cmp	r0, #4
   c:	d001      	beq.n	12 <tftp_is_correct_ack+0x12>
   e:	2000      	movs	r0, #0
  10:	e006      	b.n	20 <tftp_is_correct_ack+0x20>
D:\SAV\STM32_Documents\lwip_st_STM32\STM32F107_ETH_LwIP_V1.0.0\Utilities\lwip-1.3.1\port/tftputils.c:71
    return 0;

  /* then compare block numbers */
  if (block != tftp_extract_block(buf))
  12:	4620      	mov	r0, r4
  14:	f7ff fffe 	bl	0 <tftp_is_correct_ack>
  18:	4285      	cmp	r5, r0
  1a:	bf14      	ite	ne
  1c:	2000      	movne	r0, #0
  1e:	2001      	moveq	r0, #1
D:\SAV\STM32_Documents\lwip_st_STM32\STM32F107_ETH_LwIP_V1.0.0\Utilities\lwip-1.3.1\port/tftputils.c:75
    return 0;

  return 1;
}
  20:	bd70      	pop	{r4, r5, r6, pc}
  22:	46c0      	nop			(mov r8, r8)
